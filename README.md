# PDF Page Cutter

PDFから任意のページを抽出・分割・削除するシンプルなウェブツールです。ローカル環境で動作し、機密文書も安全に処理できます。

## 機能

- **抽出モード**: 指定したページのみを含む新しいPDFを作成
- **分割モード**: 指定したページを個別のPDFファイルに分割（ZIP形式でダウンロード）  
- **削除モード**: 指定したページを除いた新しいPDFを作成
- **柔軟なページ指定**: 範囲、リスト、除外、キーワード（奇数・偶数など）に対応
- **ドラッグ&ドロップ対応**: 直感的なファイルアップロード
- **高速処理**: qpdfが利用可能な場合は自動で高速モードに切り替え

## セットアップ

### 前提条件

- Node.js 18以上
- npm または yarn

### オンラインデモ

**フロントエンドのみ**: https://your-username.github.io/pdf-page-cutter/

※PDF処理機能を使用するにはローカル環境でのセットアップが必要です

### インストール

1. リポジトリをクローンまたはダウンロード
```bash
git clone <repository-url>
cd pdf-cutter
```

2. 依存関係をインストール
```bash
npm install
cd server && npm install
cd ../client && npm install
cd ..
```

3. アプリケーションを起動
```bash
npm run dev
```

### アクセス

- フロントエンド: http://localhost:3000
- APIサーバー: http://localhost:3001

## 使い方

### 基本的な手順

1. **PDFファイルをアップロード**
   - ドラッグ&ドロップまたはクリックしてファイルを選択
   - 最大200MB、PDFファイルのみ対応

2. **ページを指定**
   - テキストボックスにページ指定を入力
   - プリセットボタンで一般的なパターンを簡単選択

3. **処理モードを選択**
   - 抽出、分割、削除から選択

4. **処理を実行**
   - ボタンをクリックして処理開始
   - 完了後、自動でファイルがダウンロード

### ページ指定の記法

| 記法 | 説明 | 例 |
|------|------|-----|
| `1,3,5` | 特定のページ | 1, 3, 5ページ |
| `1-10` | ページ範囲 | 1〜10ページ |
| `odd` | 奇数ページ | 1, 3, 5, 7... |
| `even` | 偶数ページ | 2, 4, 6, 8... |
| `all` | すべてのページ | 全ページ |
| `first` | 最初のページ | 1ページ目 |
| `last` | 最後のページ | 最終ページ |
| `!5` | 除外 | 5ページを除く |
| `1-10,!5` | 複合指定 | 1〜10ページから5ページを除外 |
| `9,1-3` | 順序指定 | 9ページ、1〜3ページの順 |

### プリセット

よく使われるパターンは自動でプリセットボタンとして表示されます：

- **すべて**: 全ページ
- **奇数ページ**: 奇数ページのみ
- **偶数ページ**: 偶数ページのみ  
- **最初の10ページ**: 1〜10ページ（ページ数が10以上の場合）
- **表紙を除く**: 2ページ目以降
- **最終ページを除く**: 最終ページを除く全ページ

## 高速化（オプション）

### qpdfのインストール

大きなPDFファイルの処理を高速化するには、qpdfをインストールしてください：

#### Windows
```bash
# Chocolateyを使用
choco install qpdf

# Scoopを使用  
scoop install qpdf
```

#### macOS
```bash
# Homebrewを使用
brew install qpdf
```

#### Ubuntu/Debian
```bash
sudo apt-get install qpdf
```

qpdfが利用可能な場合、自動的に高速モードに切り替わります。利用できない場合はpdf-libにフォールバックします。

## 制限事項

### ファイル制限
- 最大ファイルサイズ: 200MB
- 対応形式: PDFのみ
- パスワード保護されたPDFは未対応

### ブラウザ制限
- JavaScriptが有効である必要があります
- モダンブラウザ（Chrome, Firefox, Safari, Edge）を推奨

### 処理制限
- 非常に大きなPDFの場合、メモリ不足が発生する可能性があります
- 処理時間はファイルサイズとページ数に依存します

## よくある質問

### Q: プレビューの生成が遅いのですが？
A: 大きなPDFの場合、プレビュー生成に時間がかかります。qpdfをインストールすることで高速化されます。

### Q: ZIPファイルが壊れているようです
A: ブラウザのダウンロード制限やセキュリティソフトの影響が考えられます。別のブラウザで試してみてください。

### Q: パスワード保護されたPDFを使えますか？
A: 現在はパスワード保護されたPDFには対応していません。事前にパスワードを解除してからご利用ください。

### Q: 処理が途中で止まります
A: メモリ不足の可能性があります。より小さなPDFで試すか、ページ数を減らしてみてください。

## トラブルシューティング

### サーバーが起動しない
```bash
# ポートが使用中の場合
lsof -ti:3001 | xargs kill -9  # macOS/Linux
netstat -ano | findstr :3001   # Windows

# 依存関係を再インストール
rm -rf node_modules server/node_modules client/node_modules
npm install && cd server && npm install && cd ../client && npm install
```

### 処理がエラーになる
- ファイルが破損していないか確認
- ページ指定が正しいか確認  
- ブラウザのコンソールでエラーメッセージを確認

### qpdfが認識されない
```bash
# インストール確認
qpdf --version

# パスの確認（Windows）
where qpdf

# パスの確認（macOS/Linux）  
which qpdf
```

## 開発

### テストの実行
```bash
cd server
npm test
```

### ビルド
```bash
cd client
npm run build
```

### 本番デプロイ用
```bash
npm run build
cd server
npm start
```

## 技術スタック

### フロントエンド
- React 18
- TypeScript
- Vite
- Tailwind CSS
- Lucide React (アイコン)
- React Dropzone

### バックエンド  
- Node.js
- Express
- pdf-lib (PDF処理)
- qpdf (高速PDF処理、オプション)
- multer (ファイルアップロード)
- archiver (ZIP作成)

### 開発・テスト
- Vitest (テスト)
- TypeScript
- ESLint

## デプロイメント

### GitHub Pagesへの自動デプロイ

1. GitHubリポジトリを作成
2. コードをプッシュ
3. Settings > Pages で "GitHub Actions" を選択
4. 自動的にデプロイされます

詳細は[DEPLOYMENT.md](DEPLOYMENT.md)をご覧ください。

### フル機能のデプロイ

PDF処理機能を含むフル機能を使用するには：
1. APIサーバーを別途デプロイ（Heroku, Railway等）
2. フロントエンドの設定を更新
3. 両方をデプロイ

## ライセンス

MIT License - 詳細は[LICENSE](LICENSE)ファイルをご覧ください。

## 貢献

プルリクエストやイシューの報告を歓迎します。大きな変更を行う前に、まずイシューで議論してください。

## セキュリティ

- アップロードされたファイルはメモリ上でのみ処理され、サーバーに保存されません
- 処理後のファイルも一時的にメモリに保持されるのみです
- ローカル環境で動作するため、ファイルが外部に送信されることはありません